{% extends 'base_listar.html' %}
{% load static %}
{% block title %}Lista de Clientes{% endblock %}

{% block title_filters %}
  <!-- CARD SUPERIOR: Título + Total + Filtros -->
  <div class="card-top">
    <h1>Clientes Activos</h1>

    <div class="pendiente-box">
      <h2>Total</h2>
      <p class="monto">{{ clientes|length }}</p>
    </div>

    <div class="actions">
      <form method="get">
        <a href="{% url 'clientes_agregar' %}" class="btn" style="border-radius: 12px 0 0 12px;">
          Agregar Nuevo Cliente
        </a>
        <select name="cliente">
          <option value="">-- Todos los clientes --</option>
          {% for c in clientes %}
            <option value="{{ c.id }}" {% if cliente_seleccionado == c.id|stringformat:"s" %}selected{% endif %}>
              {{ c.nombre }}
            </option>
          {% endfor %}
        </select>
        <button type="submit" class="btn" style="border-radius: 0 12px 12px 0;">Filtrar</button>
      </form>
    </div>
  </div>
{% endblock %}

{% block content %}
  <!-- CARD INFERIOR: Tabla -->
  <div class="card">
    <div class="table-container">
      <table>
        <tr>
          <th>Nombre</th>
          <th>Servicio</th>
          <th>Comisión PROCOM</th>
          <th>Factura</th>
          <th>Fecha Registro</th>
          <th>Acciones</th>
        </tr>
        {% for cliente in clientes %}
        <tr>
          <td>{{ cliente.nombre }}</td>
          <td>{{ cliente.servicio }}</td>
          <td>{{ cliente.comision_procom }}%</td>
          <td>{{ cliente.factura }}</td>
          <td>{{ cliente.fecha_registro|date:"d/m/Y H:i" }}</td>
          <td>
            <a href="{% url 'clientes_editar' cliente.id %}" class="editar">Editar</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" style="text-align:center;">No hay clientes registrados.</td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>
{% endblock %}
