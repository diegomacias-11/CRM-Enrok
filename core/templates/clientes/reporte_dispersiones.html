{% extends 'base_listar.html' %}
{% load humanize %}
{% block title %}Reporte de Dispersión — Cliente{% endblock %}

{% block title_filters %}
  <div class="card-top">
    <h1>Reporte de Dispersión — {{ cliente.nombre }}</h1>

    <div class="pendiente-box">
      <div>
        <h2>Total Dispersado</h2>
        <strong class="monto">${{ total_dispersiones|floatformat:2|intcomma }}</strong>
      </div>

      <div>
        <h2>Total Honorar</h2>
        <strong class="monto">${{ total_facturado|floatformat:2|intcomma }}</strong>
      </div>

      <div>
        <h2>Total Pendiente</h2>
        <strong class="monto">${{ total_pendiente|floatformat:2|intcomma }}</strong>
      </div>
    </div>
  </div>
{% endblock %}

{% block content %}
  <div class="card">
    <div class="table-container">
      <table>
        <tr>
          <th>Mes</th>
          <th>Total Dispersado</th>
          <th>Total Honorarios</th>
          <th>Total Pendiente</th>
          <th>Acciones</th>
        </tr>

        {% for r in resumen %}
        <tr>
          <td>{{ r.mes_nombre }} {{ r.anio }}</td>
          <td>${{ r.total_dispersiones|floatformat:2|intcomma }}</td>
          <td>${{ r.total_facturado|floatformat:2|intcomma }}</td>
          <td>${{ r.total_pendiente|floatformat:2|intcomma }}</td>
          <td>
            <a href="{% url 'detalle_cliente' %}?mes={{ r.mes }}&anio={{ r.anio }}" class="editar">
              Detalle
            </a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" style="text-align:center;">No hay registros de dispersión.</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    <div style="margin-top:.5rem; text-align:center;">
        <a href="{% url 'panel_cliente' %}" class="btn filtro_pagado">Volver</a>
    </div>
  </div>
{% endblock %}
